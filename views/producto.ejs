<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Detalle del producto</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

  <nav class="navbar navbar-dark bg-dark">
    <div class="container">
      <a href="/" class="navbar-brand">Mi Tienda</a>
    </div>
  </nav>

  <main class="container my-4">
    <h1 class="text-center">Detalle del producto</h1>

    <div id="producto-detalle" class="card shadow-sm p-4">
      <p>Cargando producto...</p>
    </div>
  </main>

  <script>
    // Obtener el ID desde EJS (inyectado por Express)
    const productoId = "<%= id %>";

    async function cargarProducto() {
      try {
        const res = await fetch(`/api/productos/${productoId}`);
        const json = await res.json();

        const cont = document.getElementById("producto-detalle");

        if (!json.state) {
          cont.innerHTML = `<div class="alert alert-danger">${json.error}</div>`;
          return;
        }

        const p = json.producto;
        cont.innerHTML = `
          <img src="${p.imagen || 'https://via.placeholder.com/400'}" class="img-fluid mb-3"/>
          <h3>${p.titulo}</h3>
          <p>${p.descripcion}</p>
          <p><strong>Precio:</strong> $${p.precio}</p>
          <hr>
          <p><strong>Vendedor:</strong> ${p.usuarioId?.nombre || 'N/A'}</p>
          <p><strong>Correo:</strong> ${p.usuarioId?.correo || 'N/A'}</p>
          <p><strong>Tel√©fono:</strong> ${p.usuarioId?.telefono || 'N/A'}</p>
        `;
      } catch (err) {
        document.getElementById("producto-detalle").innerHTML =
          `<div class="alert alert-danger">Error al cargar el producto</div>`;
      }
    }

    cargarProducto();
  </script>
</body>
</html>
